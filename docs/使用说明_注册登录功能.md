# 注册登录功能使用说明

## 功能概述

本项目已实现完整的医生注册和登录功能，可以连接后端API进行用户认证。

## API接口配置

### 注册接口
- **URL**: `https://www.universalfuture.online/api/v1/doctor/register`
- **方法**: POST
- **Content-Type**: application/json

#### 请求体格式
```json
{
  "username": "doctor_xu",
  "name": "张医生",
  "password": "123456",
  "gender": "MALE",
  "phone": "13800128000",
  "department": "中医科",
  "position": "主治医师",
  "bio": "擅长中医诊疗，从业10年"
}
```

#### 字段说明
- `username` (必填): 用户名，3-50位，只能包含字母、数字和下划线
- `password` (必填): 密码，至少6位
- `name` (必填): 医生姓名，2-50位
- `gender` (必填): 性别，可选值：MALE（男）、FEMALE（女）、OTHER（其他）
- `phone` (必填): 手机号，11位数字
- `department` (选填): 科室，最多100位
- `position` (选填): 职位，最多100位
- `bio` (选填): 个人简介，最多500位

### 登录接口
- **URL**: `https://www.universalfuture.online/api/v1/doctor/login`
- **方法**: POST
- **Content-Type**: application/json

#### 请求体格式
```json
{
  "username": "doctor_zhang",
  "password": "password123"
}
```

#### 字段说明
- `username` (必填): 用户名
- `password` (必填): 密码

## 功能特点

### 1. 表单验证
- **用户名验证**: 格式检查（字母、数字、下划线）
- **密码验证**: 最少6位字符
- **手机号验证**: 必须为11位数字
- **实时提示**: 每个字段都有友好的提示信息

### 2. 错误处理
系统能够处理以下错误情况：
- 网络连接错误
- 401 未授权（用户名或密码错误）
- 400 请求参数错误
- 404 接口不存在
- 500 服务器错误
- 用户名已存在（注册时）

### 3. 用户体验
- 登录成功后可自动跳转到首页
- 注册成功后自动跳转到登录页
- 登录状态使用sessionStorage持久化
- 支持路由守卫，未登录用户无法访问首页

## 使用方法

### 启动项目
```bash
npm install
npm run dev
```

### 访问页面
1. **登录页面**: http://localhost:5173/login
2. **注册页面**: http://localhost:5173/register
3. **首页**: http://localhost:5173/ （需要登录）

### 测试流程

#### 注册新用户
1. 访问注册页面
2. 填写所有必填字段：
   - 用户名（例如：doctor_xu）
   - 密码（至少6位）
   - 姓名（例如：张医生）
   - 性别（选择：男/女/其他）
   - 手机号（11位数字）
3. 可选填写：
   - 科室（例如：中医科）
   - 职位（例如：主治医师）
   - 个人简介
4. 点击"注册"按钮
5. 注册成功后自动跳转到登录页

#### 登录
1. 访问登录页面
2. 输入用户名和密码
3. 点击"登录"按钮
4. 登录成功后自动跳转到首页

## 代码文件说明

### 核心文件

#### `src/api/auth.js`
- 配置axios实例
- 设置API基础URL：`https://www.universalfuture.online/api/v1/doctor`
- 定义`registerDoctor`和`loginDoctor`方法
- 包含请求和响应拦截器

#### `src/views/Login.vue`
- 登录页面组件
- 用户名和密码输入
- 登录状态管理和错误处理
- 成功后存储用户信息到sessionStorage

#### `src/views/Register.vue`
- 注册页面组件
- 完整的医生信息表单
- 表单验证
- 响应多种API响应格式

#### `src/router/index.js`
- Vue Router配置
- 路由守卫实现登录检查
- 自动重定向未登录用户

## 响应格式支持

系统支持多种API响应格式：

### 成功响应格式1
```json
{
  "success": true,
  "message": "操作成功",
  "data": {...}
}
```

### 成功响应格式2
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {...}
}
```

### 成功响应格式3
```json
{
  "data": {...}
}
```

### 错误响应格式
```json
{
  "code": 400,
  "message": "错误信息",
  "error": "详细错误"
}
```

## 注意事项

1. **CORS问题**: 如果遇到跨域问题，需要后端配置允许的源
2. **网络超时**: 默认超时时间为10秒，可在`auth.js`中调整
3. **开发环境**: 生产环境部署时需要更新API地址
4. **安全性**: 当前使用sessionStorage存储token，可根据需要改为更安全的存储方式

## 调试

### 查看控制台日志
- 打开浏览器开发者工具（F12）
- 查看Console标签
- 所有API请求和响应都会被记录

### 常见问题

1. **无法连接服务器**
   - 检查网络连接
   - 确认后端服务是否正常运行
   - 确认API地址是否正确

2. **CORS错误**
   - 后端需要配置允许的请求源
   - 或者使用代理服务器

3. **401错误**
   - 用户名或密码错误
   - 检查输入是否正确

4. **400错误**
   - 请求参数错误
   - 检查必填字段是否完整
   - 检查字段格式是否正确

## 后续优化建议

1. 添加记住密码功能
2. 添加验证码功能防止暴力破解
3. 添加密码强度检测
4. 添加密码找回功能
5. 使用更安全的token存储方式
6. 添加请求重试机制
7. 添加loading动画优化用户体验
