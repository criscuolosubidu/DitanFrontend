# 后端接口配置说明

## 问题排查

如果遇到登录/注册 404 错误，请按以下步骤排查：

### 1. 确认 Apifox Mock 服务正在运行

登录接口地址：`http://127.0.0.1:4523/m1/6768102-6480118-default/api/v1/doctor/login`
注册接口地址：`http://127.0.0.1:4523/m1/6768102-6480118-default/api/v1/doctor/register`

#### 检查方法：

1. **打开 Apifox**
2. **检查 Mock 服务状态**
   - 在 Apifox 中找到项目 `m1/6768102-6480118-default`
   - 确认 Mock 服务已启动
   - 如果未启动，点击"启动 Mock 服务"按钮

3. **测试接口是否可用**
   
   在浏览器中访问以下地址测试：
   
   ```bash
   # 测试登录接口（会返回错误，但能确认接口存在）
   http://127.0.0.1:4523/m1/6768102-6480118-default/api/v1/doctor/login?username=test&password=test
   
   # 使用 curl 测试（在终端中运行）
   curl http://127.0.0.1:4523/m1/6768102-6480118-default/api/v1/doctor/login
   ```

### 2. 确认接口方法正确

#### 登录接口
- **方法**：POST
- **路径**：`/api/v1/doctor/login`
- **请求体**：
  ```json
  {
    "username": "用户名",
    "password": "密码"
  }
  ```

#### 注册接口
- **方法**：POST
- **路径**：`/api/v1/doctor/register`
- **请求体**：
  ```json
  {
    "username": "用户名",
    "password": "密码",
    "name": "医生姓名",
    "gender": "MALE",
    "phone": "13800138000",
    "department": "科室",
    "position": "职位",
    "bio": "个人简介"
  }
  ```

### 3. 常见问题

#### 问题 1：404 Not Found
**原因**：后端 Mock 服务未启动或接口路径不正确

**解决方法**：
1. 打开 Apifox
2. 检查 Mock 服务是否运行
3. 确认接口路径正确

#### 问题 2：CORS 跨域错误
**原因**：后端未配置允许跨域访问

**解决方法**：
在 Apifox Mock 设置中开启 CORS 支持

#### 问题 3：401 Unauthorized
**原因**：用户名或密码错误

**解决方法**：
1. 确认已注册用户
2. 检查用户名和密码是否正确

### 4. 修改后端地址

如果您的后端服务地址不同，需要修改以下文件：

#### 文件：`src/api/auth.js`

```javascript
// 修改这一行
const API_BASE_URL = '你的后端服务地址/api/v1/doctor'
```

### 5. 使用真实后端服务（推荐）

当您有真实的后端服务时：

1. 确认后端服务地址和端口
2. 修改 `src/api/auth.js` 中的 `API_BASE_URL`
3. 确保后端已实现以下接口：
   - POST `/api/v1/doctor/login`
   - POST `/api/v1/doctor/register`
4. 确保后端支持 CORS 跨域请求

### 6. 调试技巧

在浏览器控制台中查看：

```javascript
// 查看 API 配置
console.log('API Base URL:', 'http://127.0.0.1:4523/m1/6768102-6480118-default/api/v1/doctor')
```

在代码中添加日志：

```javascript
// 在 src/api/auth.js 中添加
console.log('Sending request to:', config.url)
console.log('Request data:', config.data)
```

## 接口规范

### 登录接口规范

**请求**
```http
POST /api/v1/doctor/login
Content-Type: application/json

{
  "username": "string",
  "password": "string"
}
```

**成功响应**
```json
{
  "code": 200,
  "message": "登录成功",
  "data": {
    "id": 1,
    "username": "test",
    "name": "张三",
    "token": "xxx"
  }
}
```

**错误响应**
```json
{
  "code": 401,
  "message": "用户名或密码错误"
}
```

### 注册接口规范

**请求**
```http
POST /api/v1/doctor/register
Content-Type: application/json

{
  "username": "string (3-50位，只能包含字母、数字和下划线)",
  "password": "string (至少6位)",
  "name": "string (2-50位)",
  "gender": "MALE|FEMALE|OTHER",
  "phone": "string (11位数字)",
  "department": "string (可选，最多100位)",
  "position": "string (可选，最多100位)",
  "bio": "string (可选)"
}
```

**成功响应**
```json
{
  "code": 200,
  "message": "注册成功",
  "data": {
    "id": 1,
    "username": "test"
  }
}
```

**错误响应**
```json
{
  "code": 400,
  "message": "用户名已存在"
}
```

## 联系支持

如果问题仍然存在，请提供以下信息：
1. 错误截图
2. 浏览器控制台完整日志
3. 后端服务状态
4. 网络请求详情（Network 标签）

